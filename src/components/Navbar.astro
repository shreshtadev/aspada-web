---
import { Image } from "astro:assets";
import logo from "../assets/Logo.png";
import MobileMenu from "./MobileMenu.astro";
---

<nav
  class="fixed top-6 left-1/2 -translate-x-1/2 w-[95%] max-w-7xl z-100 leading-tight tracking-tighter"
>
  <div
    class="bg-aspada-steel/40 backdrop-blur-2xl border border-aspada-cream/10 rounded-2xl px-6 py-3 flex justify-between items-center shadow-2xl"
  >
    <a href="/" class="flex items-center gap-3 group">
      <div
        class="w-12 h-12 bg-aspada-cream/20 rounded-lg flex items-center justify-center shadow-lg shadow-aspada-gold/20 group-hover:rotate-6 transition-transform"
      >
        <Image
          class="w-auto h-30 object-contain"
          src={logo}
          alt="Aspada Developers"
        />
      </div>
      <div class="hidden sm:flex flex-col">
        <span
          class="font-bold text-aspada-silver tracking-tighter leading-none text-lg uppercase"
          >Aspada</span
        >
        <span class="text-[9px] text-aspada-gold tracking-[0.3em] uppercase"
          >Developers</span
        >
      </div>
    </a>

    <div
      class="hidden md:flex gap-2 items-center bg-white/5 rounded-xl p-1 border border-white/5"
    >
      <a
        href="/"
        class="px-4 py-2 rounded-lg text-[11px] font-bold uppercase tracking-widest text-aspada-silver hover:bg-white/10 transition-all"
      >
        Home
      </a>

      <a
        href="/projects"
        class="px-4 py-2 rounded-lg text-[11px] font-bold uppercase tracking-widest text-aspada-silver hover:bg-white/10 transition-all"
      >
        Projects
      </a>

      <a
        href="/blog"
        class="px-4 py-2 rounded-lg text-[11px] font-bold uppercase tracking-widest text-aspada-silver hover:bg-white/10 transition-all"
      >
        Latest News
      </a>
    </div>

    <div class="flex items-center gap-4">
      <div
        class="hidden lg:flex gap-3 mr-4 border-r border-white/10 pr-4 text-aspada-silver/40"
      >
        <a
          href="https://instagram.com/aspadadevelopers/"
          class="i-lucide-instagram hover:text-aspada-cream transition"></a>
        <a
          href="https://facebook.com/aspadadevelopers"
          class="i-lucide-facebook hover:text-aspada-cream transition"></a>
        <a
          href="https://youtube.com/@aspadadevelopers/videos"
          class="i-lucide-youtube hover:text-aspada-cream transition"></a>
        <a
          href="/admin/login"
          class="i-lucide-log-in hover:text-aspada-cream transition"></a>
      </div>
      <button
        id="mobile-menu-toggle"
        class="md:hidden text-aspada-silver p-2 text-2xl"
        aria-label="Toggle Menu"
      >
        <div class="i-lucide-menu" id="menu-icon"></div>
      </button>
    </div>
  </div>

  <MobileMenu />
</nav>

<script>
  function initNav() {
    const toggle = document.getElementById("mobile-menu-toggle");
    const menu = document.getElementById("mobile-menu");
    const icon = document.getElementById("menu-icon");

    if (toggle && menu && icon) {
      toggle.addEventListener("click", () => {
        const isOpen = menu.classList.contains("opacity-100");
        if (isOpen) {
          menu.classList.replace("opacity-100", "opacity-0");
          menu.classList.replace("translate-y-0", "translate-y-4");
          menu.classList.add("pointer-events-none");
          icon.classList.replace("i-lucide-x", "i-lucide-menu");
        } else {
          menu.classList.replace("opacity-0", "opacity-100");
          menu.classList.replace("translate-y-4", "translate-y-0");
          menu.classList.remove("pointer-events-none");
          icon.classList.replace("i-lucide-menu", "i-lucide-x");
        }
      });
    }

    // Dropdown clickable logic for touch devices
    const portfolioBtn = document.getElementById("portfolio-btn");
    portfolioBtn?.addEventListener("click", (e) => {
      if (window.innerWidth < 768) return; // Let mobile menu handle it
      // Toggle focus to show dropdown on click for desktop/hybrid devices
      const parent = portfolioBtn.parentElement;
      parent?.classList.toggle("focus-within");
    });
  }

  // Initialize on load
  initNav();
  // Re-init if using Astro View Transitions
  document.addEventListener("astro:after-swap", initNav);
</script>
